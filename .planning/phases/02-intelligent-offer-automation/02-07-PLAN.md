---
phase: 02-intelligent-offer-automation
plan: "07"
type: execute
wave: 3
depends_on:
  - "02-01"
  - "02-02"
  - "02-03"
  - "02-04"
  - "02-05"
  - "02-06"
files_modified:
  - src/app/(dashboard)/offers/page.tsx
  - src/app/(dashboard)/offers/[dealId]/compose/page.tsx
  - src/app/(dashboard)/offers/[dealId]/compose/components/OfferForm.tsx
  - src/app/(dashboard)/sequences/page.tsx
  - src/app/(dashboard)/sequences/[id]/page.tsx
  - src/app/(dashboard)/sequences/components/SequenceBuilder.tsx
  - src/app/(dashboard)/offers/tracking/page.tsx
  - src/app/(dashboard)/monitoring/page.tsx
  - src/components/ui/OfferCard.tsx
  - src/components/ui/SequenceTimeline.tsx
autonomous: true
requirements:
  - OF-01
  - OF-02
  - OF-03
  - OF-04
  - OF-05
  - OF-06
  - OF-07
  - AU-01
  - AU-02
  - AU-03
  - AU-04
  - AU-05
  - AU-06

must_haves:
  truths:
    - "User can compose offer in modal/page with form (deal select, recipient email, repair costs, sequence select)"
    - "User can send offer with one click after composition"
    - "User can bulk send form (select multiple deals, one recipient, optional sequence)"
    - "Sequence builder UI shows step-by-step editor (email, wait, SMS steps)"
    - "User can see offer tracking dashboard (sent/opened/clicked/bounced status per recipient)"
    - "User can see follow-up sequence status (next step, completion %, pause/resume buttons)"
    - "Monitoring dashboard shows bounce rate, complaint rate, sender score trends"
    - "Pipeline shows creative finance badges on qualifying deals"
  artifacts:
    - path: "src/app/(dashboard)/offers/page.tsx"
      provides: "Offers list page with send form"
      exports: ["default"]
    - path: "src/app/(dashboard)/offers/[dealId]/compose/page.tsx"
      provides: "Single offer composition page"
      exports: ["default"]
    - path: "src/app/(dashboard)/offers/[dealId]/compose/components/OfferForm.tsx"
      provides: "Reusable offer form component"
      exports: ["OfferForm"]
    - path: "src/app/(dashboard)/sequences/page.tsx"
      provides: "Sequence templates list"
      exports: ["default"]
    - path: "src/app/(dashboard)/sequences/[id]/page.tsx"
      provides: "Sequence detail and builder"
      exports: ["default"]
    - path: "src/app/(dashboard)/sequences/components/SequenceBuilder.tsx"
      provides: "Sequence step editor component"
      exports: ["SequenceBuilder"]
    - path: "src/app/(dashboard)/offers/tracking/page.tsx"
      provides: "Offer tracking and deliverability dashboard"
      exports: ["default"]
    - path: "src/app/(dashboard)/monitoring/page.tsx"
      provides: "Email health monitoring dashboard"
      exports: ["default"]
  key_links:
    - from: "src/app/(dashboard)/offers/[dealId]/compose/page.tsx"
      to: "src/app/api/offers/send"
      via: "OfferForm calls POST /api/offers/send on submit"
      pattern: "fetch.*api/offers/send"
    - from: "src/app/(dashboard)/sequences/[id]/page.tsx"
      to: "src/app/api/sequences/route.ts"
      via: "SequenceBuilder calls CRUD endpoints"
      pattern: "fetch.*api/sequences"

---

<objective>
Build complete Phase 2 frontend UI: offer composition, bulk send, sequence builder, tracking dashboard, and email health monitoring.

Purpose: Make automation intuitive. Users go from deal list → compose → send → track without context switching.

Output: Complete UI for all Phase 2 workflows with real-time status updates.
</objective>

<execution_context>
@/Users/jakezebe/.claude/get-shit-done/workflows/execute-plan.md
@/Users/jakezebe/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-intelligent-offer-automation/02-CONTEXT.md
@.planning/phases/02-intelligent-offer-automation/02-RESEARCH.md
@.planning/phases/01-core-deal-sourcing-crm/01-06-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Offer composition and send UI</name>
  <files>
    src/app/(dashboard)/offers/page.tsx
    src/app/(dashboard)/offers/[dealId]/compose/page.tsx
    src/app/(dashboard)/offers/[dealId]/compose/components/OfferForm.tsx
    src/components/ui/OfferCard.tsx
  </files>
  <action>
    **1. Create `src/components/ui/OfferCard.tsx`:**
    Reusable card component for displaying offer status.

    ```typescript
    'use client';

    import { OfferedDeal } from '@prisma/client';
    import { format } from 'date-fns';

    const statusColors: Record<string, string> = {
      SENT: 'bg-blue-100 text-blue-800',
      OPENED: 'bg-green-100 text-green-800',
      CLICKED: 'bg-green-100 text-green-800',
      BOUNCED: 'bg-red-100 text-red-800',
      COMPLAINED: 'bg-red-100 text-red-800',
      UNSUBSCRIBED: 'bg-gray-100 text-gray-800',
    };

    export function OfferCard({ offer }: { offer: OfferedDeal }) {
      return (
        <div className="border rounded-lg p-4 bg-white shadow-sm">
          <div className="flex justify-between items-start mb-2">
            <div className="font-semibold">{offer.sentToEmail}</div>
            <span className={\`px-2 py-1 rounded text-sm \${statusColors[offer.status]}\`}>
              {offer.status}
            </span>
          </div>
          {offer.recipientName && (
            <p className="text-sm text-gray-600 mb-2">{offer.recipientName}</p>
          )}
          <div className="text-xs text-gray-500 space-y-1">
            <p>Sent: {format(offer.sentAt, 'MMM d, yyyy h:mm a')}</p>
            {offer.emailOpenedAt && (
              <p>Opened: {format(offer.emailOpenedAt, 'MMM d, yyyy h:mm a')}</p>
            )}
            {offer.linkClickedAt && (
              <p>Clicked: {format(offer.linkClickedAt, 'MMM d, yyyy h:mm a')}</p>
            )}
            {offer.bouncedAt && (
              <p>Bounced: {format(offer.bouncedAt, 'MMM d, yyyy h:mm a')} ({offer.bouncetype})</p>
            )}
          </div>
        </div>
      );
    }
    ```

    **2. Create `src/app/(dashboard)/offers/[dealId]/compose/components/OfferForm.tsx`:**
    Form for composing a single offer.

    ```typescript
    'use client';

    import { useState } from 'react';
    import { Deal, Property, FollowUpSequence } from '@prisma/client';
    import { calculateMAO } from '@/lib/qualification/engine';

    interface OfferFormProps {
      deal: Deal & { property: Property };
      sequences: FollowUpSequence[];
      onSubmit: (data: any) => Promise<void>;
      loading?: boolean;
    }

    export function OfferForm({ deal, sequences, onSubmit, loading }: OfferFormProps) {
      const [recipientEmail, setRecipientEmail] = useState('');
      const [recipientName, setRecipientName] = useState('');
      const [repairCosts, setRepairCosts] = useState(0);
      const [sequenceId, setSequenceId] = useState('');

      const mao = calculateMAO(deal.property.estimatedValue || 0, repairCosts);
      const offerPrice = mao * 0.95;

      const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault();
        await onSubmit({
          dealId: deal.id,
          recipientEmail,
          recipientName,
          repairCosts,
          sequenceId: sequenceId || undefined,
        });
      };

      return (
        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <label className="block text-sm font-medium">Property</label>
            <p className="text-sm text-gray-600">{deal.property.address}</p>
          </div>

          <div>
            <label className="block text-sm font-medium">Recipient Email</label>
            <input
              type="email"
              value={recipientEmail}
              onChange={(e) => setRecipientEmail(e.target.value)}
              required
              className="w-full border rounded px-3 py-2"
            />
          </div>

          <div>
            <label className="block text-sm font-medium">Recipient Name (optional)</label>
            <input
              type="text"
              value={recipientName}
              onChange={(e) => setRecipientName(e.target.value)}
              className="w-full border rounded px-3 py-2"
            />
          </div>

          <div>
            <label className="block text-sm font-medium">Estimated Repair Costs</label>
            <input
              type="number"
              value={repairCosts}
              onChange={(e) => setRepairCosts(parseFloat(e.target.value) || 0)}
              className="w-full border rounded px-3 py-2"
            />
          </div>

          <div className="bg-gray-50 p-3 rounded space-y-1 text-sm">
            <p>Estimated ARV: ${(deal.property.estimatedValue || 0).toLocaleString()}</p>
            <p>MAO (70% Rule): ${mao.toLocaleString()}</p>
            <p className="font-semibold">Our Offer: ${offerPrice.toLocaleString()}</p>
          </div>

          <div>
            <label className="block text-sm font-medium">Follow-up Sequence (optional)</label>
            <select
              value={sequenceId}
              onChange={(e) => setSequenceId(e.target.value)}
              className="w-full border rounded px-3 py-2"
            >
              <option value="">None</option>
              {sequences.map((seq) => (
                <option key={seq.id} value={seq.id}>
                  {seq.name}
                </option>
              ))}
            </select>
          </div>

          <button
            type="submit"
            disabled={loading || !recipientEmail}
            className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50"
          >
            {loading ? 'Sending...' : 'Send Offer'}
          </button>
        </form>
      );
    }
    ```

    **3. Create `src/app/(dashboard)/offers/[dealId]/compose/page.tsx`:**
    Single offer composition page.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';
    import { useParams, useRouter } from 'next/navigation';
    import { Deal, Property, FollowUpSequence } from '@prisma/client';
    import { OfferForm } from './components/OfferForm';

    export default function ComposePage() {
      const params = useParams();
      const router = useRouter();
      const dealId = params.dealId as string;

      const [deal, setDeal] = useState<Deal & { property: Property } | null>(null);
      const [sequences, setSequences] = useState<FollowUpSequence[]>([]);
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState('');

      useEffect(() => {
        // Fetch deal details
        fetch(\`/api/deals/\${dealId}\`)
          .then((res) => res.json())
          .then((data) => setDeal(data.deal))
          .catch((err) => setError(err.message));

        // Fetch sequences
        fetch('/api/sequences')
          .then((res) => res.json())
          .then((data) => setSequences(data.sequences))
          .catch((err) => console.error(err));
      }, [dealId]);

      const handleSubmit = async (data: any) => {
        setLoading(true);
        try {
          const response = await fetch('/api/offers/send', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          });

          if (!response.ok) {
            const err = await response.json();
            setError(err.error || 'Failed to send offer');
            return;
          }

          router.push('/offers/tracking?success=true');
        } catch (err: any) {
          setError(err.message);
        } finally {
          setLoading(false);
        }
      };

      if (!deal) {
        return <div className="p-4">Loading...</div>;
      }

      return (
        <div className="max-w-2xl mx-auto p-4">
          <h1 className="text-3xl font-bold mb-6">Compose Offer</h1>
          {error && <div className="bg-red-100 text-red-800 p-3 rounded mb-4">{error}</div>}
          <OfferForm deal={deal} sequences={sequences} onSubmit={handleSubmit} loading={loading} />
        </div>
      );
    }
    ```

    **4. Create `src/app/(dashboard)/offers/page.tsx`:**
    Offers list page with quick send button.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';
    import Link from 'next/link';
    import { Deal, Property } from '@prisma/client';

    export default function OffersPage() {
      const [deals, setDeals] = useState<(Deal & { property: Property })[]>([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetch('/api/deals?status=QUALIFIED')
          .then((res) => res.json())
          .then((data) => setDeals(data.deals))
          .catch(console.error)
          .finally(() => setLoading(false));
      }, []);

      if (loading) return <div className="p-4">Loading deals...</div>;

      return (
        <div className="p-4 space-y-4">
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-3xl font-bold">Qualified Deals</h1>
          </div>

          <div className="space-y-3">
            {deals.map((deal) => (
              <div key={deal.id} className="border rounded-lg p-4 flex justify-between items-center">
                <div>
                  <p className="font-semibold">{deal.property.address}</p>
                  <p className="text-sm text-gray-600">
                    Score: {deal.qualificationScore} | Equity: {deal.property.equityPercent}%
                  </p>
                </div>
                <Link href={\`/offers/\${deal.id}/compose\`}>
                  <button className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                    Send Offer
                  </button>
                </Link>
              </div>
            ))}
          </div>
        </div>
      );
    }
    ```
  </action>
  <verify>
    1. OfferCard displays offer status with proper color coding
    2. OfferForm shows all required fields (email, repair costs, sequence select)
    3. OfferForm calculates and displays MAO + offer price
    4. POST /api/offers/send called on form submit
    5. Compose page fetches deal details and sequences
    6. Offers list page shows qualified deals with send button
    7. Build passes TypeScript checks
  </verify>
  <done>
    - OfferCard UI component displays offer status and tracking info
    - OfferForm component with deal selection, email, repair costs, sequence select
    - Single offer composition page accessible from deal list
    - Real-time MAO calculation showing on form
    - All forms properly error-handled and validated
  </done>
</task>

<task type="auto">
  <name>Task 2: Sequence builder and tracking dashboards</name>
  <files>
    src/app/(dashboard)/sequences/page.tsx
    src/app/(dashboard)/sequences/[id]/page.tsx
    src/app/(dashboard)/sequences/components/SequenceBuilder.tsx
    src/app/(dashboard)/offers/tracking/page.tsx
    src/app/(dashboard)/monitoring/page.tsx
    src/components/ui/SequenceTimeline.tsx
  </files>
  <action>
    **1. Create `src/components/ui/SequenceTimeline.tsx`:**
    Visual timeline for sequence steps.

    ```typescript
    'use client';

    interface Step {
      type: 'EMAIL' | 'SMS' | 'WAIT';
      delayDays?: number;
      subject?: string;
    }

    export function SequenceTimeline({ steps }: { steps: Step[] }) {
      return (
        <div className="space-y-4">
          {steps.map((step, idx) => (
            <div key={idx} className="flex gap-4">
              <div className="flex flex-col items-center">
                <div className="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm font-bold">
                  {idx + 1}
                </div>
                {idx < steps.length - 1 && <div className="w-0.5 h-12 bg-gray-300 my-2" />}
              </div>
              <div className="flex-1 pt-1">
                <p className="font-semibold">{step.type} Step</p>
                {step.type === 'WAIT' && (
                  <p className="text-sm text-gray-600">Wait {step.delayDays} days</p>
                )}
                {step.type === 'EMAIL' && (
                  <p className="text-sm text-gray-600">{step.subject || 'Follow-up email'}</p>
                )}
                {step.type === 'SMS' && (
                  <p className="text-sm text-gray-600">Send SMS</p>
                )}
              </div>
            </div>
          ))}
        </div>
      );
    }
    ```

    **2. Create `src/app/(dashboard)/sequences/components/SequenceBuilder.tsx`:**
    Component for adding/editing sequence steps.

    ```typescript
    'use client';

    import { useState } from 'react';

    interface Step {
      type: 'EMAIL' | 'SMS' | 'WAIT';
      delayDays?: number;
      subject?: string;
      htmlContent?: string;
    }

    interface SequenceBuilderProps {
      initialSteps?: Step[];
      onSave: (steps: Step[]) => Promise<void>;
    }

    export function SequenceBuilder({ initialSteps = [], onSave }: SequenceBuilderProps) {
      const [steps, setSteps] = useState<Step[]>(initialSteps);
      const [loading, setLoading] = useState(false);

      const addStep = (type: Step['type']) => {
        const newStep: Step = { type };
        if (type === 'WAIT') newStep.delayDays = 3;
        if (type === 'EMAIL') newStep.subject = 'Follow-up';
        setSteps([...steps, newStep]);
      };

      const updateStep = (idx: number, updates: Partial<Step>) => {
        const updated = [...steps];
        updated[idx] = { ...updated[idx], ...updates };
        setSteps(updated);
      };

      const removeStep = (idx: number) => {
        setSteps(steps.filter((_, i) => i !== idx));
      };

      const handleSave = async () => {
        setLoading(true);
        try {
          await onSave(steps);
        } finally {
          setLoading(false);
        }
      };

      return (
        <div className="space-y-4">
          {steps.map((step, idx) => (
            <div key={idx} className="border rounded-lg p-4 space-y-2">
              <div className="flex justify-between items-center">
                <span className="font-semibold">Step {idx + 1}</span>
                <button
                  onClick={() => removeStep(idx)}
                  className="text-red-600 hover:text-red-800 text-sm"
                >
                  Remove
                </button>
              </div>

              {step.type === 'EMAIL' && (
                <>
                  <input
                    type="text"
                    value={step.subject || ''}
                    onChange={(e) => updateStep(idx, { subject: e.target.value })}
                    placeholder="Email subject"
                    className="w-full border rounded px-3 py-2"
                  />
                </>
              )}

              {step.type === 'WAIT' && (
                <>
                  <div>
                    <label className="text-sm">Days to wait</label>
                    <input
                      type="number"
                      value={step.delayDays || 1}
                      onChange={(e) =>
                        updateStep(idx, { delayDays: parseInt(e.target.value) })
                      }
                      className="w-full border rounded px-3 py-2"
                    />
                  </div>
                </>
              )}
            </div>
          ))}

          <div className="flex gap-2">
            <button
              onClick={() => addStep('EMAIL')}
              className="flex-1 border border-blue-600 text-blue-600 py-2 rounded hover:bg-blue-50"
            >
              + Email
            </button>
            <button
              onClick={() => addStep('WAIT')}
              className="flex-1 border border-blue-600 text-blue-600 py-2 rounded hover:bg-blue-50"
            >
              + Wait
            </button>
            <button
              onClick={() => addStep('SMS')}
              className="flex-1 border border-blue-600 text-blue-600 py-2 rounded hover:bg-blue-50"
            >
              + SMS
            </button>
          </div>

          <button
            onClick={handleSave}
            disabled={loading || steps.length === 0}
            className="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 disabled:opacity-50"
          >
            {loading ? 'Saving...' : 'Save Sequence'}
          </button>
        </div>
      );
    }
    ```

    **3. Create `src/app/(dashboard)/sequences/page.tsx`:**
    Sequence templates list.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';
    import Link from 'next/link';
    import { FollowUpSequence } from '@prisma/client';

    export default function SequencesPage() {
      const [sequences, setSequences] = useState<FollowUpSequence[]>([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetch('/api/sequences')
          .then((res) => res.json())
          .then((data) => setSequences(data.sequences))
          .finally(() => setLoading(false));
      }, []);

      return (
        <div className="p-4 space-y-4">
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-3xl font-bold">Follow-up Sequences</h1>
            <Link href="/sequences/new">
              <button className="bg-green-600 text-white px-4 py-2 rounded">
                Create Sequence
              </button>
            </Link>
          </div>

          <div className="space-y-3">
            {sequences.map((seq) => (
              <Link key={seq.id} href={\`/sequences/\${seq.id}\`}>
                <div className="border rounded-lg p-4 hover:bg-gray-50 cursor-pointer">
                  <p className="font-semibold">{seq.name}</p>
                  {seq.description && <p className="text-sm text-gray-600">{seq.description}</p>}
                </div>
              </Link>
            ))}
          </div>
        </div>
      );
    }
    ```

    **4. Create `src/app/(dashboard)/sequences/[id]/page.tsx`:**
    Sequence detail and builder.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';
    import { useParams, useRouter } from 'next/navigation';
    import { FollowUpSequence } from '@prisma/client';
    import { SequenceBuilder } from '../components/SequenceBuilder';
    import { SequenceTimeline } from '@/components/ui/SequenceTimeline';

    export default function SequenceDetailPage() {
      const params = useParams();
      const router = useRouter();
      const sequenceId = params.id as string;

      const [sequence, setSequence] = useState<FollowUpSequence | null>(null);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetch(\`/api/sequences/\${sequenceId}\`)
          .then((res) => res.json())
          .then((data) => setSequence(data.sequence))
          .finally(() => setLoading(false));
      }, [sequenceId]);

      const handleSave = async (steps: any[]) => {
        // Update sequence (endpoint in Phase 2 implementation)
        console.log('Save sequence:', steps);
      };

      if (loading) return <div className="p-4">Loading...</div>;
      if (!sequence) return <div className="p-4">Sequence not found</div>;

      return (
        <div className="max-w-4xl mx-auto p-4">
          <h1 className="text-3xl font-bold mb-2">{sequence.name}</h1>
          <p className="text-gray-600 mb-6">{sequence.description}</p>

          <div className="grid grid-cols-2 gap-6">
            <div>
              <h2 className="text-xl font-bold mb-4">Sequence Timeline</h2>
              <SequenceTimeline steps={sequence.steps as any[]} />
            </div>
            <div>
              <h2 className="text-xl font-bold mb-4">Edit Steps</h2>
              <SequenceBuilder
                initialSteps={sequence.steps as any[]}
                onSave={handleSave}
              />
            </div>
          </div>
        </div>
      );
    }
    ```

    **5. Create `src/app/(dashboard)/offers/tracking/page.tsx`:**
    Offer tracking dashboard.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';
    import { OfferedDeal } from '@prisma/client';
    import { OfferCard } from '@/components/ui/OfferCard';

    export default function TrackingPage() {
      const [offers, setOffers] = useState<OfferedDeal[]>([]);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetch('/api/offers')
          .then((res) => res.json())
          .then((data) => setOffers(data.offers))
          .finally(() => setLoading(false));
      }, []);

      if (loading) return <div className="p-4">Loading...</div>;

      const stats = {
        sent: offers.length,
        opened: offers.filter((o) => o.emailOpenedAt).length,
        clicked: offers.filter((o) => o.linkClickedAt).length,
        bounced: offers.filter((o) => o.bouncedAt).length,
      };

      return (
        <div className="p-4 space-y-6">
          <h1 className="text-3xl font-bold">Offer Tracking</h1>

          <div className="grid grid-cols-4 gap-4">
            <div className="bg-blue-50 p-4 rounded">
              <p className="text-sm text-gray-600">Sent</p>
              <p className="text-2xl font-bold">{stats.sent}</p>
            </div>
            <div className="bg-green-50 p-4 rounded">
              <p className="text-sm text-gray-600">Opened</p>
              <p className="text-2xl font-bold">{stats.opened}</p>
            </div>
            <div className="bg-green-50 p-4 rounded">
              <p className="text-sm text-gray-600">Clicked</p>
              <p className="text-2xl font-bold">{stats.clicked}</p>
            </div>
            <div className="bg-red-50 p-4 rounded">
              <p className="text-sm text-gray-600">Bounced</p>
              <p className="text-2xl font-bold">{stats.bounced}</p>
            </div>
          </div>

          <div className="space-y-3">
            {offers.map((offer) => (
              <OfferCard key={offer.id} offer={offer} />
            ))}
          </div>
        </div>
      );
    }
    ```

    **6. Create `src/app/(dashboard)/monitoring/page.tsx`:**
    Email health monitoring dashboard.

    ```typescript
    'use client';

    import { useEffect, useState } from 'react';

    interface Metrics {
      totalSent: number;
      bounceRate: number;
      complaintRate: number;
      senderScore: number;
      openRate: number;
    }

    export default function MonitoringPage() {
      const [metrics, setMetrics] = useState<Metrics | null>(null);
      const [status, setStatus] = useState<string>('');
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        fetch('/api/monitoring/status')
          .then((res) => res.json())
          .then((data) => {
            setMetrics(data.metrics);
            setStatus(data.healthStatus);
          })
          .finally(() => setLoading(false));
      }, []);

      if (loading) return <div className="p-4">Loading...</div>;
      if (!metrics) return <div className="p-4">Error loading metrics</div>;

      const healthColor = status === 'HEALTHY' ? 'text-green-600' : 'text-yellow-600';

      return (
        <div className="p-4 space-y-6">
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-3xl font-bold">Email Health</h1>
            <span className={\`text-xl font-bold \${healthColor}\`}>{status}</span>
          </div>

          <div className="grid grid-cols-3 gap-4">
            <div className="border rounded-lg p-4">
              <p className="text-sm text-gray-600 mb-2">Total Sent (30 days)</p>
              <p className="text-3xl font-bold">{metrics.totalSent}</p>
            </div>

            <div className="border rounded-lg p-4">
              <p className="text-sm text-gray-600 mb-2">Bounce Rate</p>
              <p className={metrics.bounceRate > 5 ? 'text-red-600' : 'text-green-600'}>
                <span className="text-3xl font-bold">{metrics.bounceRate.toFixed(2)}%</span>
              </p>
              <p className="text-xs text-gray-500">Threshold: 5%</p>
            </div>

            <div className="border rounded-lg p-4">
              <p className="text-sm text-gray-600 mb-2">Complaint Rate</p>
              <p className={metrics.complaintRate > 0.1 ? 'text-red-600' : 'text-green-600'}>
                <span className="text-3xl font-bold">{metrics.complaintRate.toFixed(3)}%</span>
              </p>
              <p className="text-xs text-gray-500">Threshold: 0.1%</p>
            </div>

            <div className="border rounded-lg p-4">
              <p className="text-sm text-gray-600 mb-2">Sender Score</p>
              <p className={metrics.senderScore < 80 ? 'text-red-600' : 'text-green-600'}>
                <span className="text-3xl font-bold">{metrics.senderScore}</span>
              </p>
              <p className="text-xs text-gray-500">Target: >80</p>
            </div>

            <div className="border rounded-lg p-4">
              <p className="text-sm text-gray-600 mb-2">Open Rate</p>
              <p className="text-3xl font-bold text-blue-600">{metrics.openRate.toFixed(1)}%</p>
            </div>
          </div>
        </div>
      );
    }
    ```
  </action>
  <verify>
    1. SequenceTimeline displays steps with visual timeline
    2. SequenceBuilder allows adding/editing/removing steps
    3. Sequences list page shows templates with create button
    4. Sequence detail page shows timeline + builder side-by-side
    5. Offer tracking page shows stats (sent/opened/clicked/bounced)
    6. Monitoring page shows metrics with color-coded health status
    7. All pages properly fetch data and handle loading states
    8. Build passes TypeScript checks
  </verify>
  <done>
    - SequenceTimeline UI component displays step-by-step flow
    - SequenceBuilder allows adding EMAIL/WAIT/SMS steps
    - Sequences CRUD pages (list, detail, builder)
    - Offer tracking dashboard with stats grid
    - Email health monitoring dashboard with metrics and thresholds
    - All pages properly styled and user-friendly
    - Responsive grid layouts for metrics display
  </done>
</task>

</tasks>

<verification>
1. Offer composition form shows all fields with MAO calculation
2. Sequence builder allows adding/editing steps with proper UI
3. Tracking dashboard shows sent/opened/clicked/bounced stats
4. Monitoring dashboard shows bounce rate, complaint rate, sender score
5. All pages properly fetch from API endpoints
6. Error handling and loading states implemented
7. Build passes TypeScript checks
</verification>

<success_criteria>
- Offer composition page with email/repair costs/sequence select
- Bulk send form (select deals, recipient, optional sequence)
- Sequence builder UI (add EMAIL/WAIT/SMS steps)
- Tracking dashboard shows offer stats and individual status
- Monitoring dashboard shows deliverability metrics + health status
- Pipeline integration shows creative finance badges
- All forms properly validated and error-handled
- Responsive design across all pages
</success_criteria>

<output>
After completion, create `.planning/phases/02-intelligent-offer-automation/02-07-SUMMARY.md`

After all Phase 2 plans complete, update ROADMAP.md with Phase 2 completion status and next steps for Phase 2.1 (SMS, custom templates, BatchData integration, etc.)
</output>
